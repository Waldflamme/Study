#Датасет: sp500hst.txt
#Рассчитать среднее значение за 2010 год для показателей каждого из столбцов 3-6 для одинаковых значений тикеров из столбца 2 и сохранить рассчитанную таблицу со столбцами Тикер, open , high, low, closing (где OHLC содержат среднее значение для данного тикера за 2010 год) в новом CSV файле.
#Решить задачу средствами numpy и/или pandas. Не использовать циклы и конструкции стандартного Python там, где можно использовать возможности данных библиотек.


import pandas as pd

# Шаг 1: Загрузка данных без заголовков
# Указываем имена столбцов вручную, так как в файле их нет
column_names = ['date', 'ticker', 'open', 'high', 'low', 'close', 'volume']
df = pd.read_csv('sp500hst.txt', header=None, names=column_names)

# Шаг 2: Преобразуем колонку 'date' к строке, чтобы удобно выделять год
df['date'] = df['date'].astype(str)

# Шаг 3: Отфильтровываем только строки за 2010 год (дата начинается с '2010')
df_2010 = df[df['date'].str.startswith('2010')]

# Шаг 4: Группируем по тикеру и считаем средние значения по нужным колонкам
ohlc_avg = df_2010.groupby('ticker')[['open', 'high', 'low', 'close']].mean()

# Шаг 5: Сброс индекса, чтобы тикер стал обычным столбцом (а не индексом)
ohlc_avg = ohlc_avg.reset_index()

# Шаг 6: Сохраняем итоговую таблицу в новый CSV-файл
ohlc_avg.to_csv('sp500_2010_avg_ohlc.csv', index=False)

# Показываем первые строки итогового результата
print(ohlc_avg.head())