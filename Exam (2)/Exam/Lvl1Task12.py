#Датасет: sp500hst.txt
#Создать таблицу, в которой индексом являются даты торгов, столбцами - наименования тикеров, а в ячейках хранятся объемы торгов. Заполнить эту таблицу данными из sp500hst.txt (в случае отсутствия информации для определенных сочетаний тикер-дата, сохранить в ячейке пустое значение). Сохранить результат в новый CSV файл.
#Решить задачу средствами numpy и/или pandas. Не использовать циклы и конструкции стандартного Python там, где можно использовать возможности данных библиотек.


import pandas as pd

# Шаг 1: Загрузить файл без заголовков, вручную задав имена столбцов
column_names = ['date', 'ticker', 'open', 'high', 'low', 'close', 'volume']
df = pd.read_csv('sp500hst.txt', header=None, names=column_names)

# Шаг 2: Убедимся, что колонка 'date' — строка (для корректной обработки и индексации)
df['date'] = df['date'].astype(str)

# Шаг 3: Создаем сводную таблицу: строки — даты, столбцы — тикеры, значения — объем торгов
# Используем pivot для создания таблицы нужного вида
volume_table = df.pivot(index='date', columns='ticker', values='volume')

# Шаг 4: Сохраняем полученную таблицу в CSV (отсутствующие значения сохраняются как NaN)
volume_table.to_csv('sp500_volume_table.csv')

# (Необязательный шаг) Покажем часть таблицы
print(volume_table.head())