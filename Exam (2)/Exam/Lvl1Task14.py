#Датасет Titanic.csv
#Загрузить набор данных из датасета с информацией о пассажирах Титаника и посмотреть на первые несколько строк данных, чтобы убедиться, что данные загружены корректно.
#Выполнить первичный анализ данных: определить форму датасета с помощью и получить общую информации о колонках.Найти все строки, где есть пропущенные значения и и заполнить пропуски средним значением для количественных колонок.
# Сгруппировать данные по портам отправления пассажиров и рассчитать средний возраст.
# Выбрать всех пассажиров, которые погибли и были старше 30 лет, рассчитывать общее количество таких пассажиров.


import pandas as pd

# === 1. Загрузка данных ===
# Чтение CSV-файла с информацией о пассажирах Титаника
df = pd.read_csv('Titanic.csv')

# === 2. Просмотр первых нескольких строк ===
# Это позволяет убедиться, что данные загружены корректно
print("Первые строки таблицы:")
print(df.head())

# === 3. Первичный анализ данных ===

# Определяем форму датасета: количество строк и столбцов
print("\nФорма таблицы (строки, столбцы):", df.shape)

# Получаем информацию о типах данных и количестве непустых значений в каждом столбце
print("\nОбщая информация о столбцах:")
print(df.info())

# === 4. Поиск строк с пропущенными значениями ===

# Находим строки, в которых есть хотя бы один пропущенный элемент
missing_rows = df[df.isnull().any(axis=1)]
print("\nСтроки с пропущенными значениями:")
print(missing_rows)

# === 5. Заполнение пропущенных значений средними ===

# Вычисляем средние значения только для количественных (числовых) столбцов
numeric_means = df.select_dtypes(include='number').mean()

# Заполняем пропуски в числовых колонках соответствующими средними значениями
df_filled = df.fillna(value=numeric_means)

# === 6. Группировка по портам отправления (Embarked) и расчет среднего возраста ===

# Группируем данные по порту и рассчитываем средний возраст пассажиров в каждой группе
avg_age_by_port = df_filled.groupby('Embarked')['Age'].mean()
print("\nСредний возраст пассажиров по портам отправления:")
print(avg_age_by_port)

# === 7. Выбор погибших пассажиров старше 30 лет ===

# Фильтрация по условиям: пассажир не выжил и был старше 30 лет
died_over_30 = df_filled[(df_filled['Survived'] == 0) & (df_filled['Age'] > 30)]

# Подсчитываем общее количество таких пассажиров
count_died_over_30 = died_over_30.shape[0]
print("\nКоличество погибших пассажиров старше 30 лет:", count_died_over_30)